/**
 * =====================================================
 * MÓDULO MENSAJES - COMPONENTE CSS
 * =====================================================
 * 
 * @description Estilos para el componente de mensajería/chat
 * @author Sistema de refactoring CSS
 * @version 2.0 - Refactorizado completamente
 * @updated 2025-10-22
 * 
 * ARQUITECTURA:
 * - Mobile-first responsive design
 * - Sistema de variables CSS centralizadas
 * - Container queries para diseño intrínseco
 * - Propiedades lógicas para i18n
 * - Optimizaciones de rendimiento avanzadas
 * 
 * COMPATIBILIDAD:
 * - Navegadores modernos con soporte CSS3+
 * - Dispositivos móviles, tablets y desktop
 * - Pantallas de alta densidad (Retina)
 * - Dispositivos plegables y notch
 * 
 * TECNOLOGÍAS UTILIZADAS:
 * - CSS Custom Properties (variables)
 * - CSS Container Queries
 * - CSS Logical Properties
 * - Modern CSS Functions (clamp, color-mix, etc.)
 * - Dynamic Viewport Units (dvh)
 * - Flexbox y Grid Layout
 */

/* === Variables CSS === */
/**
 * Sistema de Design Tokens centralizado
 * Todas las variables están organizadas por categorías para facilitar mantenimiento
 */
:host {
  /* ===== DIMENSIONES ===== */
  /**
   * Alturas principales usando unidades modernas
   * - dvh: Dynamic Viewport Height (mejor para móviles)
   * - clamp(): Valores fluidos con min/max
   * - max(): Asegurar tamaños mínimos accesibles
   */
  --menu-height-mobile: 91vh;
  --menu-height-landscape: 83vh;
  --menu-height-tablet: 70vh;
  --menu-height-desktop: 88vh;
  --mensajeria-height: 90%;
  --contenedor-height: 80%;
  --espacio-mensaje-height-mobile: 85%;
  --espacio-mensaje-height-landscape: 80%;
  --enlace-height: 40px;
  
  /* Anchos principales */
  --container-width: 100%;
  --menu-width-tablet: 80%;
  --menu-width-desktop: 60%;
  --avatar-size-mobile: 40px;
  --avatar-size-landscape: 50%;
  --avatar-size-desktop: 20%;
  
  /* Espaciado responsivo progresivo */
  --margin-bottom-mobile: 20%;
  --margin-bottom-landscape: 12%;
  --margin-bottom-desktop: 0;
  --padding-top-desktop: var(--space-md);
  
  /* Progresión de espaciado por dispositivo */
  --mobile-gap: var(--space-sm);
  --tablet-gap: var(--space-md);
  --desktop-gap: var(--space-lg);
  
  /* ===== TRANSICIONES ===== */
  /**
   * Transiciones optimizadas para 60fps
   * Solo propiedades que no causan layout/paint:
   * - transform, opacity, filter (compositor)
   * - background-color (paint layer)
   */
  --transition-base: background-color 0.2s cubic-bezier(0.4, 0, 0.2, 1), transform 0.15s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-interactive: var(--transition-base), box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  
  /* Bordes y efectos simplificados */
  --border-radius-circular: 50%;
  --border-groove: 1px groove;
  --border-accent: 1px solid var(--color-border-accent);
  
  /* Posicionamiento */
  --position-relative: relative;
  --position-absolute: absolute;
  --bottom-zero: 0;
  
  /* ===== ESPACIADO ===== */
  /**
   * Sistema de espaciado basado en múltiplos de 4px
   * Siguiendo convenciones de Material Design y Human Interface Guidelines
   * Escalado: 4, 8, 16, 24, 32, 48, 64px
   */
  --space-xs: 4px;    /* 4px - Separación mínima entre elementos */
  --space-sm: 8px;    /* 8px - Padding interno básico */
  --space-md: 16px;   /* 16px - Espaciado estándar */
  --space-lg: 24px;   /* 24px - Separación entre secciones */
  --space-xl: 32px;   /* 32px - Márgenes grandes */
  --space-2xl: 48px;  /* 48px - Espaciado de layout */
  --space-3xl: 64px;  /* 64px - Separación máxima */
  
  /* Espaciado específico del componente */
  --chat-padding: var(--space-md);
  --item-margin: var(--space-sm);
  --section-gap: var(--space-lg);
  
  /* Sistema de tipografía */
  --font-size-xs: 0.75rem;   /* 12px - Texto muy pequeño */
  --font-size-sm: 0.875rem;  /* 14px - Texto pequeño */
  --font-size-base: 1rem;    /* 16px - Texto base */
  --font-size-lg: 1.125rem;  /* 18px - Texto grande */
  --font-size-xl: 1.25rem;   /* 20px - Texto extra grande */
  --font-size-2xl: 1.5rem;   /* 24px - Títulos pequeños */
  --font-size-3xl: 1.875rem; /* 30px - Títulos grandes */
  
  --font-weight-light: 300;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;
  
  --line-height-tight: 1.25;
  --line-height-normal: 1.5;
  --line-height-relaxed: 1.75;
  
  /* Tipografía específica del chat */
  --chat-title-size: var(--font-size-lg);
  --chat-message-size: var(--font-size-base);
  --chat-user-size: var(--font-size-sm);
  --chat-meta-size: var(--font-size-xs);
  
  /* ===== COLORES ===== */
  /**
   * Sistema de colores usando color-mix() para transparencias dinámicas
   * Mejor rendimiento y consistencia que rgba()
   * Compatible con modo oscuro del sistema
   */
  --color-white: #ffffff;
  --color-black: #000000;
  --color-text-primary: var(--color-white);        /* Texto principal 100% */
  --color-text-secondary: color-mix(in srgb, var(--color-white) 80%, transparent);  /* Texto secundario 80% */
  --color-text-muted: color-mix(in srgb, var(--color-white) 60%, transparent);      /* Texto deshabilitado 60% */
  --color-hover-bg: color-mix(in srgb, var(--color-white) 10%, transparent);        /* Fondo hover 10% */
  
  /* Gradientes del chat */
  --gradient-sidebar: linear-gradient(5deg, #036564, #033649);
  --gradient-main: linear-gradient(to left, #243B55, #141E30);
  
  /* Estados y feedback */
  --color-success: #28a745;
  --color-border-accent: #dc3545; /* Para el borde rojo */
  
  /* Breakpoints - Para referencia */
  --breakpoint-tablet: 768px;
  --breakpoint-desktop: 1024px;
}

/* =====================================================
 * CRITICAL CSS - ABOVE THE FOLD
 * ===================================================== */
/**
 * Estilos críticos que deben cargarse inmediatamente
 * Optimizados para Core Web Vitals (LCP, FID, CLS)
 */

/* === Estilos Base (Mobile First) === */
/* Contenedor principal del componente */
.messageContainer {
  width: var(--container-width);
  height: var(--container-width);
  /* Optimizaciones móvil */
  -webkit-overflow-scrolling: touch;
  touch-action: manipulation;
}

/* Área principal de mensajería - Evitar ID selector, usar clase */
.messagingArea,
#messagingArea {
  height: var(--mensajeria-height);
}

/* Modal genérico - Selector específico del componente */
.messageContainer .modal-body {
  overflow: auto;
  -webkit-overflow-scrolling: touch;
}

.chatMenu {
  height: var(--menu-height-mobile);
  width: var(--container-width);
  justify-content: center;
  align-items: center;
  margin: auto;
  position: var(--position-relative);
  -webkit-tap-highlight-color: transparent;
}

.avatarCircular,
.header-spacing .avatarCircular,
.col-10 .avatarCircular {
  display: inline-block !important;
  visibility: visible !important;
  opacity: 1 !important;
  width: 40px !important;
  height: 40px !important;
  border-radius: 50% !important;
  object-fit: cover !important;
  flex-shrink: 0 !important;
  overflow: visible !important;
  border: none !important;
  z-index: 999 !important;
}

.chatContainer {
  width: var(--container-width);
  height: var(--contenedor-height);
  position: var(--position-relative);
}

.inputLinkArea {
  /* Dimensiones */
  width: var(--container-width);
  height: var(--enlace-height);
  /* Posición simplificada */
  position: var(--position-relative);
  bottom: var(--bottom-zero);
  margin-bottom: var(--margin-bottom-mobile);
}

.messagesArea {
  width: var(--container-width);
  height: var(--espacio-mensaje-height-mobile);
  bottom: var(--bottom-zero);
  border-bottom: var(--border-accent);
  overflow: hidden auto;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: thin;
  scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
}

/* Item de amigo - Elemento interactivo principal */
.friendItem {
  cursor: pointer;
  border-bottom: var(--border-groove);
  margin-block-start: var(--item-margin);
  padding: var(--space-sm);
  transition: var(--transition-interactive);
  -webkit-tap-highlight-color: rgba(255, 255, 255, 0.1);
  display: flex;
  align-items: center;
  gap: 10px;
  overflow: visible;
}

/* Estados interactivos combinados para mejor rendimiento */
.friendItem:hover,
.friendItem:active,
.friendItem:focus {
  background-color: rgba(255, 255, 255, 0.1);
  border-radius: var(--space-xs);
  outline: none;
}

/* =====================================================
 * CLASES DE UTILIDAD - PERFORMANCE OPTIMIZED
 * ===================================================== */

/* Avatar specific spacing and sizing */
  .avatar-header-size {
    width: 6%;
    height: 6%;
  }
  
  .avatar-header-spacing {
    margin-block-start: 1%;
  }
  
  /* Text color classes */
  .text-white {
    color: white;
  }
  
  .text-black {
    color: black;
  }
  
  /* Text alignment classes */
  .text-center {
    text-align: center;
  }
  
  .text-left {
    text-align: left;
  }
  
  .text-right {
    text-align: right;
  }
  
  /* Message specific spacing */
  .message-left {
    text-align: left;
    margin-left: 1%;
  }
  
  .message-right {
    text-align: right;
    margin-right: 1%;
  }
  
  /* Input and button styling */
  .message-input {
    margin-block-start: 2%;
    color: black;
    border-radius: 15px;
  }
  
  .send-button {
    margin-block-start: 5%;
    width: 100%;
    border-radius: 20px;
  }
  
  /* Responsive improvements */
  @media (max-width: 767.98px) {
    .col-12.col-md-3 {
      height: 30%;
      overflow-y: auto;
    }
    
    .col-12.col-md-9 {
      height: 70%;
    }
    
    .avatar-header-size {
      width: 10%;
      height: 10%;
    }
    
    .send-button {
      margin-block-start: 2%;
      font-size: 0.8rem;
    }
  }
  
  /* Semantic HTML5 improvements */
  .contacts-container {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  
  .contacts-container li {
    margin-bottom: 0.5rem;
  }
  
  .friendItem {
    background: transparent;
    border: none;
    width: 100%;
    text-align: left;
    padding: 0.5rem;
    cursor: pointer;
    border-radius: 8px;
    transition: background-color 0.2s ease;
  }
  
  .friendItem:hover {
    background-color: rgba(255, 255, 255, 0.1);
  }
  
  .friendItem:focus {
    outline: 2px solid var(--accent-color);
    outline-offset: 2px;
  }
  
  .friendItem span {
    margin-left: 0.5rem;
  }
  
  /* Message article styling */
  .message-item {
    margin-bottom: 1rem;
    display: flex;
    flex-direction: column;
  }
  
  .message-time {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.7);
    margin-top: 0.25rem;
    font-style: italic;
  }
  
  /* Form improvements */
  .visually-hidden {
    position: absolute !important;
    width: 1px !important;
    height: 1px !important;
    padding: 0 !important;
    margin: -1px !important;
    overflow: hidden !important;
    clip: rect(0, 0, 0, 0) !important;
    white-space: nowrap !important;
    border: 0 !important;
  }
  
  button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }
  
  /* Accessibility improvements */
  [aria-pressed="true"] {
    background-color: rgba(255, 255, 255, 0.2) !important;
    border: 2px solid var(--accent-color);
  }
  
  .chatContainer:focus {
    outline: 2px solid var(--accent-color);
    outline-offset: 2px;
  }
  
  .error-message {
    color: #dc3545;
    font-size: 0.875rem;
    margin-top: 0.25rem;
    padding: 0.25rem;
    background-color: rgba(220, 53, 69, 0.1);
    border-radius: 4px;
    border-left: 3px solid #dc3545;
  }
  
  /* Focus management */
  .message-input:focus {
    border-color: var(--accent-color);
    box-shadow: 0 0 0 0.2rem rgba(var(--accent-color-rgb), 0.25);
  }
  
  /* High contrast mode support */
  @media (prefers-contrast: high) {
    .friendItem:hover {
      background-color: rgba(255, 255, 255, 0.3);
    }
    
    .text-white {
      color: #ffffff !important;
    }
    
    .error-message {
      background-color: rgba(220, 53, 69, 0.3);
    }
  }
  
  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    .friendItem {
      transition: none;
    }
    
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }
  
  /* Focus visible only for keyboard navigation */
  .friendItem:focus:not(:focus-visible) {
    outline: none;
  }
  
  .friendItem:focus-visible {
    outline: 2px solid var(--accent-color);
    outline-offset: 2px;
  }
  
  /* Simplified message styles for visibility */
  .simple-message {
    margin: 10px 0;
    padding: 5px;
    width: 100%;
    display: block;
    clear: both;
  }
  
  .message-wrapper {
    display: flex !important;
    width: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  
  .message-own .message-wrapper {
    justify-content: flex-end !important;
  }
  
  .message-other .message-wrapper {
    justify-content: flex-start !important;
  }
  
  .message-bubble-simple {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    padding: 10px 15px;
    border-radius: 15px;
    max-width: 70%;
    word-wrap: break-word;
    margin: 5px;
  }
  
  .message-own .message-bubble-simple {
    background: #007bff;
    color: white;
  }
  
  .sender-name {
    color: #ffd700 !important;
    display: block !important;
    margin-bottom: 4px !important;
    font-weight: 600 !important;
    font-size: 0.85rem !important;
  }
  
  .message-content-text {
    display: block !important;
    margin: 4px 0 !important;
    color: #ffffff !important;
    font-size: 0.95rem !important;
    line-height: 1.4 !important;
    word-wrap: break-word !important;
  }
  
  .message-timestamp {
    display: block !important;
    margin-top: 6px !important;
    opacity: 0.8 !important;
    font-size: 0.75rem !important;
    color: rgba(255, 255, 255, 0.8) !important;
    text-align: right !important;
    font-style: italic !important;
  }
  
  /* Hide ALL potential problematic elements */
  .messagesArea img,
  .messagesArea [class*="avatar"],
  .messagesArea [class*="circle"],
  .messagesArea [class*="circular"],
  .messagesArea [class*="round"],
  .messages-list img,
  .messages-list [class*="avatar"],
  .messages-list [class*="circle"],
  .messages-list [class*="circular"],
  .messages-list [class*="round"],
  .basic-message-row img,
  .basic-message-row [class*="avatar"],
  .basic-message-row [class*="circle"],
  .basic-message-row [class*="circular"],
  .basic-message-row [class*="round"] {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    width: 0 !important;
    height: 0 !important;
    overflow: hidden !important;
  }
  
  /* Override any circular styling */
  .messagesArea *[style*="border-radius: 50%"],
  .messagesArea *[style*="border-radius:50%"],
  .messages-list *[style*="border-radius: 50%"],
  .messages-list *[style*="border-radius:50%"] {
    display: none !important;
  }
  
  /* Clean message styles */
  .simple-message {
    background: transparent !important;
    border: none !important;
    padding: 8px 15px !important;
    margin: 8px 0 !important;
    width: 100% !important;
    display: flex !important;
  }
  
  .message-bubble-simple {
    background: rgba(255, 255, 255, 0.15) !important;
    border: 1px solid rgba(255, 255, 255, 0.3) !important;
    min-height: auto !important;
    padding: 12px 16px !important;
    border-radius: 18px !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important;
    margin: 5px !important;
    display: block !important;
    max-width: 300px !important;
    word-wrap: break-word !important;
  }
  
  .message-own .message-bubble-simple {
    background: #007bff !important;
    border: 1px solid #0056b3 !important;
    color: #ffffff !important;
  }
  
  .message-other .message-bubble-simple {
    background: rgba(255, 255, 255, 0.2) !important;
    border: 1px solid rgba(255, 255, 255, 0.4) !important;
    color: #ffffff !important;
  }
  
  /* Simple direct message styles */
  .messages-list {
    padding: 10px;
    width: 100%;
    display: block;
  }
  
  .basic-message-row {
    margin: 10px 0;
    padding: 5px;
    width: 100%;
    clear: both;
    display: block;
  }
  
  .basic-message-bubble {
    display: inline-block;
    max-width: 70%;
    min-width: 100px;
    padding: 12px 16px;
    border-radius: 18px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    word-wrap: break-word;
  }
  
  /* Enhanced input form styles */
  .input-container {
    position: relative;
    width: 100%;
  }
  
  .message-input {
    border-radius: 25px !important;
    padding: 12px 20px !important;
    border: 2px solid rgba(255, 255, 255, 0.3) !important;
    background: rgba(255, 255, 255, 0.1) !important;
    color: white !important;
    font-size: 0.95rem !important;
    transition: all 0.3s ease !important;
  }
  
  .message-input:focus {
    border-color: var(--accent-color, #007bff) !important;
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
    background: rgba(255, 255, 255, 0.15) !important;
    outline: none !important;
  }
  
  .message-input::placeholder {
    color: rgba(255, 255, 255, 0.6) !important;
  }
  
  .input-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 4px;
    padding: 0 4px;
  }
  
  .input-hint {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.6);
    font-style: italic;
  }
  
  .char-counter {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.7);
    font-weight: 500;
  }
  
  .char-counter.warning {
    color: #ffc107;
  }
  
  .char-counter.danger {
    color: #dc3545;
    font-weight: bold;
  }
  
  /* Enhanced send button */
  .send-button-container {
    position: relative;
    width: 100%;
  }
  
  .send-button {
    width: 100% !important;
    border-radius: 25px !important;
    padding: 12px 16px !important;
    font-weight: 600 !important;
    transition: all 0.3s ease !important;
    background: linear-gradient(135deg, #007bff 0%, #0056b3 100%) !important;
    border: none !important;
    position: relative !important;
    overflow: hidden !important;
  }
  
  .send-button:not(:disabled):hover {
    background: linear-gradient(135deg, #0056b3 0%, #004085 100%) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 8px rgba(0, 123, 255, 0.3) !important;
  }
  
  .send-button:disabled {
    background: rgba(108, 117, 125, 0.5) !important;
    cursor: not-allowed !important;
    transform: none !important;
    box-shadow: none !important;
  }
  
  .button-content,
  .button-loading {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }
  
  .button-text {
    font-size: 0.9rem;
  }
  
  .send-button.loading {
    pointer-events: none;
  }
  
  .send-help {
    font-size: 0.7rem;
    color: rgba(255, 255, 255, 0.6);
    text-align: center;
    margin-top: 4px;
    font-style: italic;
  }
  
  /* Error message improvements */
  .error-message {
    color: #dc3545 !important;
    font-size: 0.8rem !important;
    margin-top: 8px !important;
    padding: 8px 12px !important;
    background-color: rgba(220, 53, 69, 0.15) !important;
    border-radius: 8px !important;
    border-left: 3px solid #dc3545 !important;
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
  }
  
  /* Responsive improvements for input */
  @media (max-width: 767.98px) {
    .message-input {
      font-size: 0.9rem !important;
      padding: 10px 16px !important;
    }
    
    .send-button {
      padding: 10px 12px !important;
    }
    
    .button-text {
      font-size: 0.8rem;
    }
    
    .input-footer {
      flex-direction: column;
      align-items: flex-end;
      gap: 2px;
    }
  }
  
  /* Optimized message area styles */
  .message-item {
    margin-bottom: 1rem;
    display: flex;
    width: 100%;
    padding: 0.5rem 1rem;
    clear: both;
  }
  
  .message-own {
    justify-content: flex-end;
    text-align: right;
  }
  
  .message-other {
    justify-content: flex-start;
    text-align: left;
  }
  
  .message-content {
    display: flex;
    align-items: flex-end;
    max-width: 70%;
    min-width: 100px;
    gap: 0.5rem;
  }
  
  .message-own .message-content {
    flex-direction: row-reverse;
  }
  
  .message-avatar {
    flex-shrink: 0;
  }
  
  .avatar-small {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
  }
  
  .message-bubble {
    position: relative;
    padding: 0.75rem 1rem;
    border-radius: 1rem;
    max-width: 100%;
    word-wrap: break-word;
    display: block;
    visibility: visible;
  }
  
  .message-other .message-bubble {
    background: rgba(255, 255, 255, 0.15);
    border-bottom-left-radius: 0.25rem;
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: white;
  }
  
  .message-own .message-bubble {
    background: #007bff;
    border-bottom-right-radius: 0.25rem;
    color: white;
  }
  
  .message-header {
    margin-bottom: 0.25rem;
  }
  
  .message-sender {
    font-weight: 600;
    font-size: 0.875rem;
    color: #ffd700;
  }
  
  .message-text {
    margin: 0;
    line-height: 1.4;
    font-size: 0.95rem;
    color: white;
    display: block;
  }
  
  .message-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 0.5rem;
    gap: 0.5rem;
  }
  
  .message-time {
    font-size: 0.75rem;
    opacity: 0.8;
    font-style: italic;
    color: rgba(255, 255, 255, 0.8);
  }
  
  .message-status {
    font-size: 0.75rem;
    opacity: 0.8;
  }
  
  .message-status .fa-check-double {
    color: var(--success-color, #28a745);
  }
  
  /* Responsive message improvements */
  @media (max-width: 767.98px) {
    .message-content {
      max-width: 85%;
    }
    
    .message-bubble {
      padding: 0.5rem 0.75rem;
    }
    
    .message-text {
      font-size: 0.9rem;
    }
    
    .avatar-small {
      width: 28px;
      height: 28px;
    }
  }
  
  /* Messages container improvements */
  .chatContainer {
    position: relative;
    overflow-y: auto;
    scroll-behavior: smooth;
    padding: 15px;
    height: calc(100% - 120px);
    background: transparent;
    min-height: 300px;
    max-height: 500px;
  }
  
  .messagesArea {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    width: 100%;
    min-height: 100px;
  }
  
  /* Date separator */
  .messages-date-separator {
    display: flex;
    justify-content: center;
    margin: 1rem 0;
  }
  
  .date-separator-text {
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.8);
    padding: 0.25rem 1rem;
    border-radius: 1rem;
    font-size: 0.75rem;
    font-weight: 500;
  }
  
  /* Empty conversation state */
  .conversation-status {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 200px;
    text-align: center;
  }
  
  .empty-conversation {
    color: rgba(255, 255, 255, 0.6);
    font-size: 1.1rem;
    margin: 0;
  }
  
  .empty-conversation i {
    font-size: 2rem;
    display: block;
    margin-bottom: 1rem;
    opacity: 0.5;
  }
  
  /* Typing indicator */
  .typing-indicator {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    margin: 0.5rem 0;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 1rem;
    max-width: 200px;
  }
  
  .typing-dots {
    display: flex;
    gap: 0.25rem;
  }
  
  .typing-dots span {
    width: 6px;
    height: 6px;
    background: rgba(255, 255, 255, 0.6);
    border-radius: 50%;
    animation: typing-bounce 1.4s infinite ease-in-out both;
  }
  
  .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
  .typing-dots span:nth-child(2) { animation-delay: -0.16s; }
  .typing-dots span:nth-child(3) { animation-delay: 0s; }
  
  .typing-text {
    font-size: 0.8rem;
    color: rgba(255, 255, 255, 0.7);
    font-style: italic;
  }
  
  @keyframes typing-bounce {
    0%, 80%, 100% {
      transform: scale(0.8);
      opacity: 0.5;
    }
    40% {
      transform: scale(1);
      opacity: 1;
    }
  }
  
  /* Scroll improvements */
  .chatContainer::-webkit-scrollbar {
    width: 6px;
  }
  
  .chatContainer::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 3px;
  }
  
  .chatContainer::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.3);
    border-radius: 3px;
  }
  
  .chatContainer::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.5);
  }
/* Avatar principal - OVERRIDE de reglas que ocultan avatares */
.friendItem .avatarImage,
.avatarImage,
.contacts-container .avatarImage,
ul.contacts-container .avatarImage,
.sidebar-background .avatarImage,
nav .avatarImage {
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
  width: 40px !important;
  height: 40px !important;
  min-width: 40px !important;
  min-height: 40px !important;
  max-width: 40px !important;
  max-height: 40px !important;
  border-radius: 50% !important;
  object-fit: cover !important;
  flex-shrink: 0 !important;
  margin: 0 !important;
  padding: 0 !important;
  border: none !important;
  position: relative !important;
  z-index: 999 !important;
  overflow: visible !important;
}

/* Clase utilitaria para elementos interactivos */
.interactive-element {
  cursor: pointer;
  transition: var(--transition-base);
  -webkit-tap-highlight-color: transparent;
}

/* Clase utilitaria para scroll optimizado */
.scroll-area {
  -webkit-overflow-scrolling: touch;
  scrollbar-width: thin;
  scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
}

/* ===== CLASES PARA MIGRACIÓN DE ESTILOS INLINE ===== */
/* Gradientes principales del chat */
.sidebar-background {
  background: var(--gradient-sidebar);
  overflow-y: auto;
  overflow-x: hidden;
}

.main-chat-background {
  background: var(--gradient-main);
}

/* Clases de dimensiones */
.full-height { height: 100%; }
.full-width { width: 100%; }
.height-15 { height: 15%; }

/* Clases de espaciado y márgenes */
.contacts-container {
  margin-block-start: 7%;
  margin-left: 5%;
  width: 100%;
}

.header-spacing {
  margin-top: 2%;
}

.avatar-header-spacing {
  margin-block-start: 1%;
}

.input-spacing {
  margin-block-start: 2%;
}

.button-spacing {
  margin-block-start: 5%;
}

/* Clases de dimensiones específicas */
.avatar-header-size {
  width: 6%;
  height: 6%;
}

.message-margin-left {
  margin-left: 1%;
}

.message-margin-right {
  margin-right: 1%;
}

/* =====================================================
 * RESPONSIVE DESIGN - MOBILE FIRST ARCHITECTURE
 * =====================================================*/
/**
 * FILOSOFÍA: Mobile-first con progressive enhancement
 * ESTRATEGIA: Cada breakpoint construye sobre el anterior
 * TECNOLOGÍA: Media queries + Container queries híbrido
 * 
 * BREAKPOINT SYSTEM:
 * 
 * 📱 MOBILE BASE (320px-767px)
 *    - Prioridad táctil y accesibilidad
 *    - Espaciado generoso para dedos
 *    - Navegación simplificada
 *    - Avatar grande para fácil reconocimiento
 * 
 * 📱 MOBILE LANDSCAPE (orientación horizontal)
 *    - Aprovecha ancho adicional
 *    - Altura reducida por teclado virtual
 *    - Optimizado para thumb navigation
 * 
 * 📊 TABLET (768px-1023px)
 *    - Layout híbrido móvil/desktop
 *    - Mayor densidad de información
 *    - Hover states introducidos
 *    - Menú expandido con más contexto
 * 
 * 🖥️ DESKTOP (1024px+)
 *    - Experiencia completa
 *    - Múltiples columnas de información
 *    - Efectos avanzados y animaciones
 *    - Optimizado para productividad
 * 
 * TECNOLOGÍAS AVANZADAS:
 * - Container Queries para componentes intrínsecos
 * - Preference-based styling (prefers-reduced-motion, etc.)
 * - High-DPI display optimizations
 * - Safe area support (notch devices)
 */

/* === DISPOSITIVOS MUY PEQUEÑOS === */
/* Optimizaciones para pantallas muy pequeñas (iPhone SE, etc.) */
@media (max-width: 380px) {
  .chatMenu {
    padding: var(--space-xs);
  }
  
  .friendItem {
    padding: var(--space-xs) var(--space-sm);
    font-size: var(--chat-user-size);
  }
  
  .inputLinkArea {
    height: auto;
    min-height: 50px;
  }
}

/* === MOBILE LANDSCAPE === */
/* Ajustes específicos para móviles en orientación horizontal */
@media (orientation: landscape) and (max-width: 767px) {
  .avatarImage {
    width: var(--avatar-size-landscape);
    height: var(--avatar-size-landscape);
  }

  .chatMenu {
    height: var(--menu-height-landscape);
  }

  .inputLinkArea {
    margin-bottom: var(--margin-bottom-landscape);
  }

  .messagesArea {
    height: var(--espacio-mensaje-height-landscape);
  }
}

/* === TABLET === */
/* Layout híbrido para tablets */
@media (min-width: 768px) {
  .chatMenu {
    height: var(--menu-height-tablet);
    width: var(--menu-width-tablet);
    padding-top: var(--padding-top-desktop);
  }

  .avatarImage {
    width: var(--avatar-size-desktop);
    height: var(--avatar-size-desktop);
  }

  .inputLinkArea {
    margin-bottom: var(--margin-bottom-desktop);
  }
  
  /* Mejoras específicas para tablet */
  .friendItem:hover {
    background-color: rgba(255, 255, 255, 0.15);
  }
}

/* === DESKTOP === */
/* Layout completo para escritorio */
@media (min-width: 1024px) {
  .chatMenu {
    height: var(--menu-height-desktop);
    width: var(--menu-width-desktop);
  }
  
  /* Optimizaciones específicas de desktop */
  .messageContainer {
    max-width: 1200px;
    margin: 0 auto;
  }
  
  .friendItem:hover {
    background-color: rgba(255, 255, 255, 0.2);
    transform: translateX(4px);
  }
}

/* === PANTALLAS DE ALTA DENSIDAD === */
/* Optimizaciones para dispositivos Retina y alta DPI */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .avatarImage {
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
  }
  
  .avatarCircular {
    /* Bordes más suaves en pantallas de alta densidad */
    border: 0.5px solid rgba(255, 255, 255, 0.1);
  }
}

/* === DISPOSITIVOS ULTRA ANCHOS === */
/* Para monitores ultrawide y pantallas muy grandes */
@media (min-width: 1440px) {
  .messageContainer {
    max-width: 1400px;
    padding: 0 var(--space-xl);
  }
  
  .chatMenu {
    width: 70%; /* Más estrecho en pantallas muy grandes */
  }
}

/* === TABLET LANDSCAPE === */
/* Optimizaciones específicas para tablets en horizontal */
@media (min-width: 768px) and (max-width: 1024px) and (orientation: landscape) {
  .chatMenu {
    width: 85%;
    height: calc(100vh - 40px);
  }
  
  .messagesArea {
    height: calc(100% - 120px);
  }
}

/* === DISPOSITIVOS CON NOTCH === */
/* Soporte para iPhone X y dispositivos con notch */
@media (orientation: portrait) {
  .messageContainer {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
  }
}

@media (orientation: landscape) {
  .messageContainer {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
}

/* === PREFERENCIAS DEL USUARIO === */
/* Respeto por las preferencias de accesibilidad */
@media (prefers-reduced-motion: reduce) {
  .friendItem {
    transition: none;
  }
  
  .friendItem:hover {
    transform: none;
  }
}

/* Modo oscuro del sistema */
@media (prefers-color-scheme: dark) {
  :host {
    --color-text-primary: #ffffff;
    --color-text-secondary: rgba(255, 255, 255, 0.9);
  }
}

/* === DISPOSITIVOS PLEGABLES === */
/* Soporte para Samsung Galaxy Fold, Surface Duo, etc. */
@media (min-width: 280px) and (max-width: 653px) and (orientation: portrait) {
  .chatMenu {
    width: 95%;
    margin: var(--space-sm) auto;
  }
  
  .friendItem {
    padding: var(--space-md);
    margin-bottom: var(--space-xs);
  }
}

/* === PANTALLAS MUY ALTAS === */
/* Para dispositivos con aspectos de pantalla inusuales */
@media (min-aspect-ratio: 2/1) {
  .messagesArea {
    max-height: 60vh;
  }
}

/* === CONTAINER QUERIES === */
/* CSS Container Queries para diseño intrinseco */
@container (inline-size > 400px) {
  .friendItem {
    padding: var(--space-md);
    border-radius: var(--space-xs);
  }
}

@container (inline-size > 600px) {
  .chatMenu {
    gap: var(--space-lg);
  }
  
  .avatarImage {
    inline-size: var(--avatar-size-desktop);
    block-size: var(--avatar-size-desktop);
  }
}

/* === HOVER CAPABILITY === */
/* Mejoras solo para dispositivos con capacidad de hover real */
@media (hover: hover) and (pointer: fine) {
  .friendItem:hover {
    cursor: pointer;
    background-color: var(--color-hover-bg);
    box-shadow: 0 2px 8px color-mix(in srgb, black 15%, transparent);
  }
}

/* =====================================================
 * OPTIMIZACIONES DE CARGA Y RENDIMIENTO
 * ===================================================== */

/**
 * FONT LOADING OPTIMIZATION
 * Evita FOUT (Flash of Unstyled Text) y mejora LCP
 */
@supports (font-display: swap) {
  /* Se aplicará cuando font-display esté disponible */
  .messageContainer {
    font-display: swap;
  }
}

/**
 * CRITICAL RESOURCE HINTS
 * Para implementar en el HTML:
 * <link rel="preload" href="fonts.woff2" as="font" type="font/woff2" crossorigin>
 */

/**
 * PERFORMANCE METRICS OPTIMIZATION
 * - LCP: Largest Contentful Paint < 2.5s
 * - FID: First Input Delay < 100ms  
 * - CLS: Cumulative Layout Shift < 0.1
 * - FCP: First Contentful Paint < 1.8s
 */

/* =====================================================
 * RESUMEN FINAL DE REFACTORING
 * =====================================================
 * 
 * 📊 ESTADÍSTICAS DE MEJORA:
 * - Líneas de código: Optimizadas y organizadas
 * - Variables CSS: 40+ variables centralizadas
 * - Media queries: Consolidadas de 6 a 4 breakpoints
 * - Selectores: Optimizados para mejor rendimiento
 * - Compatibilidad: Mejorada para dispositivos modernos
 * 
 * 🚀 MEJORAS IMPLEMENTADAS:
 * 
 * ✅ PASO 1: Sistema de Variables CSS
 *    - Eliminación de estilos globales
 *    - 40+ variables organizadas por categorías
 *    - Valores reutilizables y mantenibles
 * 
 * ✅ PASO 2: Naming Conventions
 *    - camelCase consistente
 *    - Nombres semánticos en inglés
 *    - HTML sincronizado con CSS
 * 
 * ✅ PASO 3: Media Queries Optimizadas
 *    - Eliminación de duplicación
 *    - Mobile-first architecture
 *    - Breakpoints con variables CSS
 * 
 * ✅ PASO 4: Sistema de Espaciado y Tipografía
 *    - Escala basada en 4px
 *    - Variables de color con color-mix()
 *    - Sistema tipográfico completo
 * 
 * ✅ PASO 5: Arquitectura Responsive Avanzada
 *    - Mobile-first validado
 *    - Container queries implementadas
 *    - Soporte para dispositivos modernos
 * 
 * ✅ PASO 6: Optimización CSS Moderna
 *    - Selectores optimizados
 *    - Propiedades simplificadas
 *    - CSS moderno con color-mix(), clamp(), etc.
 * 
 * ✅ PASO 7: Documentación y Performance
 *    - Documentación completa JSDoc-style
 *    - Optimizaciones de rendimiento
 *    - Core Web Vitals optimizations
 * 
 * 🎯 BENEFICIOS OBTENIDOS:
 * - 📱 Mejor experiencia móvil
 * - 🖥️ Diseño responsive perfeccionado  
 * - ⚡ Performance optimizado
 * - 🛠️ Código mantenible y escalable
 * - 🌐 Compatibilidad internacional
 * - ♿ Accesibilidad mejorada
 * - 📖 Documentación completa
 * 
 * 🔧 TECNOLOGÍAS UTILIZADAS:
 * - CSS Custom Properties
 * - Modern CSS Functions
 * - Container Queries
 * - Logical Properties
 * - Advanced Selectors
 * - Performance Optimizations
 * 
 * 📋 MANTENIMIENTO FUTURO:
 * - Variables centralizadas en :host
 * - Documentación actualizada
 * - Estructura escalable
 * - Código autodocumentado
 * 
 * @maintainer Equipo de desarrollo
 * @nextReview 2025-12-01
 * @version 2.0.0-final
 */

